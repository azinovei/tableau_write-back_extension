<!DOCTYPE html>
<html>

<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, height=device-height, initial-scale=1">
  <title>Write-back Configuration</title>
  <!-- Favicon -->
  <link rel="shortcut icon" href="../favicon.ico" />
  <!-- Jquery -->
  <script src="https://code.jquery.com/jquery-3.3.1.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script>
  <script src="https://code.jquery.com/ui/1.12.1/jquery-ui.js" integrity="sha256-T0Vest3yCU7pafRw9r+settMBX6JkKN06dqBnpQ8d30=" crossorigin="anonymous"></script>
  <!-- <script src="../lib/js/jquery-3.3.1.min.js"></script> -->
  <!-- <script src="../lib/js/jquery-ui-1.12.1.js"></script>  -->
  <!-- Popper -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.12.9/umd/popper.min.js" integrity="sha384-ApNbgh9B+Y1QKtv3Rn7W3mgPxhU9K/ScQsAP7hUibX39j7fakFPskvXusvfa0b4Q" crossorigin="anonymous"></script>
  <!-- <script src="../lib/js/popper-1.12.9.min.js"></script>  -->
  <!-- Bootstrap 4.0-->
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css" integrity="sha384-Gn5384xqQ1aoWXA+058RXPxPg6fy4IWvTNh0E263XmFcJlSAwiGgFAW/dAiS6JXm" crossorigin="anonymous">
  <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/js/bootstrap.min.js" integrity="sha384-JZR6Spejh4U02d8jOt6vLEHfe/JQGiRRSQQxSfFWpi1MquVdAyjUar5+76PVCmYl" crossorigin="anonymous"></script>
  <!-- <link rel="stylesheet" href="../lib/css/bootstrap-4.0.min.css"> -->
  <!-- <script src="../lib/js/bootstrap-4.0.min.js"></script> -->
 <!-- Font Awesome -->
  <script defer src="https://use.fontawesome.com/releases/v5.0.6/js/all.js"></script>
  <!-- <script src="../lib/js/fontawesome-5.1.0.js"></script> -->
  <!-- Tableau Extensions library -->
  <script src="../lib/tableau.extensions.1.latest.js"></script>
  <!-- Extension style sheets and javascript code -->
  <script src="../js/XportConfigure.js"></script>
  <link rel="stylesheet" href="../css/configuration.css">
  <link rel="stylesheet" href="../css/xpand.css">
</head>

<body>
  <div id="config-top" class="xp-top">
    <div class="xp-bar xp-left-align bar-theme">
        <a class="xp-bar-item xp-left xp-button xp-hide-xtra-small" href="https://www.xpand-it.com/" target="_blank"><img class='logo' src="../img/xpandit-white.png"/></a>
        <div class="xp-bar-item xp-left xp-button">
          <h2>Configuration</h2>
        </div>
    </div>
  </div>
  
  <div id="config-container" class="xform-container">
    <div class="row step" id="divWorksheetSelector">
      <div class="col-sm-12 right">
        <h4>Worksheet</h4>
        <h5>Select the Worksheet</h5>
        <button type="button" class="config-help-btn xp-grey xp-hover-black xp-small" data-toggle="tooltip" data-html="true" data-placement="bottom" title="Select the worksheet that will be used in the extension to get data"><i class="fas fa-question-circle"></i></button>
        <form class="form-horizontal">
          <div class="form-group form-inline">
            <select class="form-control form-control-sm selector" id="wsheetselect">
            </select>
          </div>
        </form>
        <form>
          <label class="checkboxes">Extract all worksheet data
              <input type="checkbox" id="extract_all_data">
              <span class="checkmark"></span>
          </label>
          <button type="button" class="config-help-btn xp-grey xp-hover-black xp-small" data-toggle="tooltip" data-html="true" data-placement="bottom" title="If selected, this will extract all the data from the worksheet and display it in the datatable">
            <i class="fas fa-question-circle"></i>
          </button>
        </form>
      </div>
    </div>
    <!-- Endpoint URL Insert -->
    <div class="row step" id="endpointURLInsert">
      <div class="col-sm-12 right">
        <h4>Endpoint<h4>
        <h5>Type</h5>
        <button type="button" class="config-help-btn xp-grey xp-hover-black xp-small" data-toggle="tooltip" data-html="true" data-placement="bottom" 
        title="If using an endpoint other than the Google Spreadsheet, please set the option to Other"><i class="fas fa-question-circle"></i></button>
        <form class="form-horizontal">
          <div class="form-group">
            <label class="container-radio">Google Spreadsheet
              <input type="radio" name="googleSpreadsheet" value="true">
              <span class="checkmark-radio"></span>
            </label>
            <label class="container-radio">Other
              <input type="radio" name="googleSpreadsheet" value="false">
              <span class="checkmark-radio"></span>
            </label>
          </div>
        </form>
        <h5>URL</h5>
        <button type="button" class="config-help-btn xp-grey xp-hover-black xp-small" data-toggle="tooltip" data-html="true" data-placement="bottom" title="Set the REST API Endpoint URL"><i class="fas fa-question-circle"></i></button>
        <form class="form-horizontal">
          <div class="form-group form-inline">
            <textarea rows="2" cols="50" class="form-control form-control-sm endpoint" id="newEndpointURL"></textarea>
          </div>
        </form>
        <h5>Select the Spreadsheet <i>(Optional)</i></h5>
        <button type="button" class="config-help-btn xp-grey xp-hover-black xp-small" data-toggle="tooltip" data-html="true" data-placement="bottom" title="If you are using <b>Google Spreadsheets</b>, select the name for the Sheet where data will be inserted. <b>Default:</b> Tableau">
          <i class="fas fa-question-circle"></i></button>
        <form class="form-horizontal">
          <div class="form-group form-inline">
            <input class="form-control form-control-sm selector" id="wgooglesheetselect" type="text">
          </div>
        </form>
      </div>
    </div>
    <!-- New Columns Input -->
    <div class="row step" id="divNewColumnsInsert">
      <div class="col-sm-12 right">
        <h4>DataTable</h4>
        <form>
          <label class="checkboxes">Display Measures
            <input type="checkbox" id="xport_view_measures">
            <span class="checkmark"></span>
          </label>
          <button type="button" class="config-help-btn xp-grey xp-hover-black xp-small" data-toggle="tooltip" data-html="true" data-placement="bottom" title="Measures will be displayed in the datatable if this option is selected">
            <i class="fas fa-question-circle"></i>
          </button>
        </form>
        <form>
          <label class="checkboxes">Send only selected rows
            <input type="checkbox" id="xport_selected_rows">
            <span class="checkmark"></span>
          </label>
          <button type="button" class="config-help-btn xp-grey xp-hover-black xp-small" data-toggle="tooltip" data-html="true" data-placement="bottom" title="Only the rows selected in the datatable will be sent to the endpoint">
            <i class="fas fa-question-circle"></i>
          </button>
        </form>
        
        <br>
        <h5>Add Column <i>(Optional)</i></h5>
        <button type="button" class="config-help-btn xp-grey xp-hover-black xp-small" data-toggle="tooltip" data-html="true" data-placement="bottom" title="<b>Add</b> New Columns to show and edit in the extension datatable. Use the <i class='fas fa-arrows-alt-v'></i> to select the order they are displayed in the datatable">
          <i class="fas fa-question-circle"></i>
        </button>
        <form class="form-horizontal add-form-horizontal">
          <div class="form-group form-inline add-form" id="0">
            <input class="form-control form-control-sm selector-columns" id="newColumnInsert" type="text" placeholder="Column Name" required>
            <input class="form-control form-control-sm selector-columns" id="newColumnInsert-value" type="text" placeholder="Default Value" required>
            <input class="btn btn-add btn-sm" type="button" id="newColumnSet" value="Add" onclick="setNewColumn()">
            <input class="btn btn-remove btn-sm" type="button" id="newColumnSet" value="Remove" onclick="removeColumn()" style="display:none;">
            <i class="fas fa-arrows-alt-v" id="dragicon" style="display: none; width:4%;" ></i>
            <i id="dragicon-holder" style="width:4%;"></i>
          </div>
          <ul id="sortable">
            <!-- <li class="ui-state-default">
              <div class="form-group form-inline add-form" id="1">
                <input class="form-control form-control-sm selector-columns" id="newColumnInsert" type="text" placeholder="Column Name" required disabled>
                <input class="form-control form-control-sm selector-columns" id="newColumnInsert-value" type="text" placeholder="Default Value" required disabled>
                <input class="btn btn-add btn-sm" type="button" id="newColumnSet" value="Add" onclick="setNewColumn()" style="display:none;">
                <input class="btn btn-remove btn-sm" type="button" id="newColumnSet" value="Remove" onclick="removeColumn()">
              </div>
            </li> -->
          </ul>
        </form>
        <br>
        <h5>Write-Back Fields</h5>
        <button type="button" class="config-help-btn xp-grey xp-hover-black xp-small" data-toggle="tooltip" data-html="true" data-placement="bottom" title="Select the fields that will be sent to the endpoint">
          <i class="fas fa-question-circle"></i>
        </button>
        <form>
          <span class="xp-bar-item" id="write_back_fields">
          </span>
        </form>
      </div>
    </div>
  </div>
  <!-- Footer -->
  <div id= "config-bottom" class="xp-bottom xp-top-border">
    <div class="footer left">
      <button class="btn btn-secondary" type="button" onclick="clearSettings()">Clear All</button>
      <button class="btn btn-success" type="button" id="submit" onclick="submit()" disabled>Submit</button>
      <div class="xp-margin-top-20 xp-hide-xtra-small xp-hide-low-height">
        <div class="xp-link">
          <a class="xp-button xp-center xp-white xp-medium xp-hover-black" href="https://xpandit.github.io/tableau_write-back_extension/" target="_blank"><i>See documentation</i></a>
        </div>
        <div class="xp-link">
          <a class="xp-button xp-center xp-white xp-medium xp-hover-black" href="mailto:tableau@xpand-it.com" title="Send Mail"><i>Get in touch for Support</i></a>
        </div>
        <!-- <div class="xp-link">
          <a class="xp-button xp-center xp-white xp-medium xp-hover-black" href="https://www.xpand-it.com" target="_blank" title="Xpand IT">https://www.xpand-it.com</a>
        </div> -->
      </div>
  </div>
</body>

</html>